<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <title></title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.11.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.11.1/mapbox-gl.css' rel='stylesheet' />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

  <style>
    body { margin:0; padding:0; }
    #map { position:absolute; top:7em; bottom:0; width:100%; }
  </style>
</head>
<body>

<div style='padding:0.25em' id='street'>
  <p style='font-family:monospace'> Add one of 'schuylkill_expressway', 'allegheny_ave', 'broad_street', or 'i95'.</p>
  <input type='text' id='street-name' name='street-name'>
  <input type='submit' id='add' value='add'>
  <input type='submit' id='remove' value='remove'>
</div>
<div id='map'></div>
<script>

mapboxgl.accessToken = 'pk.eyJ1IjoiYWFyb25kZW5uaXMiLCJhIjoiem5LLURoYyJ9.T3tswGTI5ve8_wE-a02cMw';

var phillyMap = new mapboxgl.Map({
  container: 'map', // container id
  style: 'mapbox://styles/mapbox/streets-v8', //stylesheet location
  center: [-75.14, 39.95], // starting position
  zoom: 11 // starting zoom
});

phillyMap.on('load', function() {

  var add = document.getElementById('add'),
      remove = document.getElementById('remove');

  add.addEventListener('click', function() {
    var query = document.getElementById('street-name').value;
    loadStreet(query);
  });

  remove.addEventListener('click', function() {
    var query = document.getElementById('street-name').value;
    removeStreet(query);
  });

});

function removeStreet(street) {
  phillyMap.removeLayer(street);
  phillyMap.removeSource(street);
}

function loadStreet(street) {

  d3.json(street + '.geojson', function(err,data) {

    var feature = data.features[0];

    phillyMap.addSource(street, {
        "type": "geojson",
        "data": feature
    });

    phillyMap.addLayer({
        "id": street,
        "type": "line",
        "source": street,
        "layout": {
            "line-join": "round",
            "line-cap": "round"
        },
        "paint": {
            "line-color": "#888",
            "line-width": 8
        }
    });

  });

}

</script>

</body>
</html>
